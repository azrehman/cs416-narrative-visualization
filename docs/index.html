<!DOCTYPE html>
<head>
    cs411 narrative visualization
</head>
<div id="container"></div>
<script type="module">
    console.log('hello');
    import * as d3 from 'https://cdn.jsdelivr.net/npm/d3@7/+esm';

    const dateParser = d3.timeParse('%Y-%m-%d');

    const data = d3
        .csv('../data/indexProcessed.csv', (d) => {
            return {
                index: d.Index,
                date: dateParser(d.Date),
                close: +d.CloseUSD,
            };
        })
        .then((data) => {
            const marketsData = {
                NYSE: data.filter(({ index }) => index == 'NYA'), // New York Stock Exchange
                NASDAQ: data.filter(({ index }) => index == 'IXIC'), // NASDAQ
                HKSE: data.filter(({ index }) => index == 'HSI'), // Hong Kong Stock Exchange
                TSE: data.filter(({ index }) => index == 'N225'), // Tokyo Stock Exchange
                EUR: data.filter(({ index }) => index == 'N100'), // Euronext
                NSEI: data.filter(({ index }) => index == 'NSEI'), // National Stock Exchange of India
            };

            // const marketsData = d3.nest().key(d => d.index).entries(data); // every index

            plot(marketsData);
        })
        .catch((error) => {
            console.log(error);
        });

    console.log('bye');
    // load data

    // const dataa = await d3;
    // .csv('../data/indexProcessed.csv')
    // .then((data) => {
    //   console.log(typeof data);
    //   console.log(data);
    // })

    // Declare the chart dimensions and margins.
    // const width = 640;
    // const height = 400;
    // const margin = { top: 20, right: 30, bottom: 30, left: 40 };

    // TODO
    // tell story about covid bad for markets
    // each stock exchange at a time
    // in the end let user plot chosen stock exchange for a given time period?
</script>
